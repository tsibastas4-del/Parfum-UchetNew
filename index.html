<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‚ú® PerfumeFlow Pro v18.1 (Smart Fix)</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

    <nav class="navbar">
        <div class="navbar-brand">
            <i class="fa-solid fa-spray-can-sparkles"></i> PerfumeFlow
            <button class="theme-toggle" onclick="toggleTheme()" title="–ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É">
                <i id="theme-icon" class="fa-solid fa-moon"></i>
            </button>
            <button class="theme-toggle" onclick="openSettingsModal()" style="margin-left: 5px;"><i
                    class="fa-solid fa-cog"></i></button>
        </div>

        <div class="navbar-links">
            <button class="nav-btn active" onclick="showSection('dashboard', this)"><i
                    class="fa-solid fa-chart-pie"></i> –ì–æ–ª–æ–≤–Ω–∞</button>
            <button class="nav-btn" onclick="showSection('multi-calculator', this)"><i
                    class="fa-solid fa-list-check"></i> –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
            <button class="nav-btn" onclick="showSection('transactions', this)"><i
                    class="fa-solid fa-clock-rotate-left"></i> –Ü—Å—Ç–æ—Ä—ñ—è</button>
            <button class="nav-btn" onclick="showSection('tasks', this)"><i class="fa-solid fa-clipboard-list"></i>
                –ó–∞–¥–∞—á—ñ</button>
            <button class="nav-btn" onclick="showSection('ai-assistant', this)"><i class="fa-solid fa-robot"></i>
                AI –ü–æ–º—ñ—á–Ω–∏–∫</button>
            <button class="nav-btn" onclick="showSection('smm-creator', this)"><i class="fa-solid fa-camera-retro"></i>
                SMM</button>
            <button class="nav-btn" onclick="showSection('admin-panel', this)"><i class="fa-solid fa-gears"></i>
                –ê–¥–º—ñ–Ω–∫–∞</button>
        </div>
    </nav>

    <div id="toast-container"></div>

    <div class="container">

        <section id="dashboard" class="content-section active">
            <h2>üëã –í—ñ—Ç–∞—î–º–æ! –û–≥–ª—è–¥ –∑–∞ —Å—å–æ–≥–æ–¥–Ω—ñ</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>–í–∏—Ä—É—á–∫–∞ —Å—å–æ–≥–æ–¥–Ω—ñ</h3>
                    <div class="value" id="dash-revenue">0 ‚Ç¥</div>
                </div>
                <div class="stat-card green">
                    <h3>–ü—Ä–∏–±—É—Ç–æ–∫ —Å—å–æ–≥–æ–¥–Ω—ñ</h3>
                    <div class="value" id="dash-profit">0 ‚Ç¥</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #F59E0B, #D97706);">
                    <h3>–ü—Ä–æ–¥–∞–∂—ñ–≤</h3>
                    <div class="value" id="dash-count">0</div>
                </div>
                <div class="stat-card danger" id="dash-low-stock-count">
                    <h3>–ù–∏–∑—å–∫–∏–π –ó–∞–ø–∞—Å</h3>
                    <div class="value" id="dash-low-stock-count-value">0</div>
                </div>
            </div>

            <!-- CHARTS SECTION -->
            <div class="grid-2-col" style="margin-bottom: 20px;">
                <div class="card">
                    <h3>üìà –î–∏–Ω–∞–º—ñ–∫–∞ –ø—Ä–æ–¥–∞–∂—ñ–≤ (30 –¥–Ω—ñ–≤)</h3>
                    <canvas id="salesChart"></canvas>
                </div>
                <div class="card">
                    <h3>üèÜ –ü–æ–ø—É–ª—è—Ä–Ω—ñ –∞—Ä–æ–º–∞—Ç–∏</h3>
                    <canvas id="topProductsChart"></canvas>
                </div>
            </div>
            <div class="card">
                <h3><i class="fa-solid fa-trophy"></i> –¢–æ–ø-5 –ü–æ–ø—É–ª—è—Ä–Ω–∏—Ö –ê—Ä–æ–º–∞—Ç—ñ–≤ (–∑–∞ –æ–±'—î–º–æ–º)</h3>
                <div class="table-responsive">
                    <table id="top-products-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>–ù–∞–∑–≤–∞ –ü–∞—Ä—Ñ—É–º—É</th>
                                <th class="text-right">–ü—Ä–æ–¥–∞–Ω–æ</th>
                                <th class="text-right">–í–∏—Ä—É—á–∫–∞</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="card">
                <h3><i class="fa-solid fa-bolt"></i> –®–≤–∏–¥–∫—ñ –¥—ñ—ó</h3>
                <div class="grid-2-col">
                    <button class="btn-primary"
                        onclick="showSection('multi-calculator', document.querySelectorAll('.nav-btn')[1])"><i
                            class="fa-solid fa-plus"></i> –ù–æ–≤–µ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
                    <button class="btn-success"
                        onclick="showSection('tasks', document.querySelectorAll('.nav-btn')[4])"><i
                            class="fa-solid fa-clipboard-list"></i> –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ó–∞–¥–∞—á—ñ</button>
                </div>
            </div>
        </section>

        <section id="tasks" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-clipboard-list"></i> –°–ø–∏—Å–æ–∫ –ó–∞–≤–¥–∞–Ω—å</h2>
                <div id="tasks-list-container" style="margin-top: 20px;"></div>
            </div>
        </section>

        <!-- REMOVED: QUICK SALE SECTION (input-form) -->

        <section id="multi-calculator" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-basket-shopping"></i> –ö–æ—à–∏–∫ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
                <div class="grid-3-col" style="margin-bottom: 15px;">
                    <div><label>–ù–∞—Ü—ñ–Ω–∫–∞</label><select id="saleMarkupTierOrder"></select></div>
                    <div><label>–î–∂–µ—Ä–µ–ª–æ</label><select id="saleSourceOrder"></select></div>
                    <div><label>–ö–ª—ñ—î–Ω—Ç</label><input type="text" id="clientNameOrder" placeholder="–Ü–º'—è –∫–ª—ñ—î–Ω—Ç–∞"
                            list="clientList" onchange="checkClientLoyalty(this)"></div>
                    <div>
                        <label>–ó–Ω–∏–∂–∫–∞ (%)</label>
                        <select id="discountSelectOrder" style="border: 2px solid var(--border);">
                            <option value="0">0%</option>
                            <option value="1">1%</option>
                            <option value="2">2%</option>
                            <option value="3">3%</option>
                            <option value="4">4%</option>
                            <option value="5">5%</option>
                        </select>
                    </div>
                </div>

                <!-- ORDER PARSER -->
                <div class="parser-area">
                    <label>–í—Å—Ç–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç –∑ –º–µ—Å–µ–Ω–¥–∂–µ—Ä–∞:</label>
                    <textarea id="pasteAreaOrder" placeholder="–í—Å—Ç–∞–≤—Ç–µ —Ç–µ–∫—Å—Ç —Å—é–¥–∏..."></textarea>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button class="btn-primary" onclick="smartParseAI('order')"
                            style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">
                            <i class="fa-solid fa-robot"></i> AI –†–æ–∑–±—ñ—Ä
                        </button>
                    </div>
                </div>

                <h3 style="margin-top: 20px;"><i class="fa-solid fa-truck-moving"></i> –†–µ–∫–≤—ñ–∑–∏—Ç–∏ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏</h3>
                <div class="grid-2-col" style="margin-bottom: 15px;">
                    <div><label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É</label><input type="text" id="phoneOrder" placeholder="+380..."></div>
                    <div><label>–ü–Ü–ë (–ø–æ–≤–Ω—ñ—Å—Ç—é)</label><input type="text" id="fullNameOrder"
                            placeholder="–Ü–≤–∞–Ω–æ–≤ –Ü–≤–∞–Ω..."></div>
                    <div><label>–ú—ñ—Å—Ç–æ</label><input type="text" id="cityOrder" placeholder="–ù–∞–ø—Ä: –ö–∏—ó–≤"></div>
                    <div><label>–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ù–ü</label><input type="text" id="postOfficeOrder"
                            placeholder="‚ÑñX –∞–±–æ –ê–¥—Ä–µ—Å–∞"></div>
                </div>
                <label>–ö–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</label>
                <textarea id="commentsOrder" rows="2" placeholder="–ù–∞–ø—Ä: –°–∫–∏–Ω—É—Ç–∏ —Ä–µ–∫–≤—ñ–∑–∏—Ç–∏ –Ω–∞ –í–∞–π–±–µ—Ä..."
                    style="margin-bottom: 20px;"></textarea>
                <div
                    style="background: var(--bg-input); padding: 15px; border-radius: 8px; border: 1px dashed var(--border); margin-bottom: 15px;">
                    <div class="grid-2-col">
                        <div><label>–ü–∞—Ä—Ñ—É–º</label><input type="text" id="orderPerfumeName" list="perfumeList"></div>
                        <div><label>–û–±'—î–º</label><select id="orderFlaconVolume"></select></div>
                    </div>
                    <button class="btn-warning" style="margin-top: 10px;" onclick="addItemToOrder()"><i
                            class="fa-solid fa-plus-circle"></i> –î–æ–¥–∞—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é</button>
                </div>

                <div class="table-responsive">
                    <table id="order-list-table">
                        <thead>
                            <tr>
                                <th>–ü–∞—Ä—Ñ—É–º</th>
                                <th class="text-right">–û–±'—î–º</th>
                                <th class="text-right">–¶—ñ–Ω–∞</th>
                                <th class="text-right">–î—ñ—è</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <div id="orderTotalSection"
                    style="margin: 20px 0; font-size: 1.2rem; font-weight: bold; text-align: right; color: var(--primary);">
                </div>

                <h3 style="margin-top: 20px;"><i class="fa-solid fa-copy"></i> –¢–µ–∫—Å—Ç –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–¥–ª—è –ö–ª—ñ—î–Ω—Ç–∞)</h3>
                <textarea id="orderSummaryOutput" rows="8" readonly placeholder="–¢–µ–∫—Å—Ç –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑'—è–≤–∏—Ç—å—Å—è —Ç—É—Ç..."
                    style="margin-bottom: 10px;"></textarea>
                <button class="btn-warning" onclick="copyOrderSummary()"><i class="fa-solid fa-copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏
                    —Ç–µ–∫—Å—Ç</button>
                <button class="btn-primary" onclick="generateAIOrderMessage()"
                    style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">
                    <i class="fa-solid fa-robot"></i> ü§ñ –®–Ü –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                </button>
                <label>–ù–æ–º–µ—Ä –¢–¢–ù (–æ–ø—Ü—ñ–π–Ω–æ)</label>
                <input type="text" id="ttnNumberOrder" placeholder="–ù–æ–º–µ—Ä –¢–¢–ù" style="margin-bottom: 20px;">

                <div class="grid-2-col" style="margin-top: 20px;">
                    <button class="btn-success" onclick="processOrder()" id="processOrderBtn"><i
                            class="fa-solid fa-cash-register"></i> –û—Ñ–æ—Ä–º–∏—Ç–∏</button>
                    <button class="btn-danger" onclick="clearOrder()"><i class="fa-solid fa-trash"></i>
                        –û—á–∏—Å—Ç–∏—Ç–∏</button>
                </div>
            </div>
        </section>

        <section id="report" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-chart-line"></i> –ó–≤—ñ—Ç–Ω—ñ—Å—Ç—å</h2>
                <div class="grid-2-col" style="margin-bottom: 15px;">
                    <div><label>–ó –¥–∞—Ç–∏</label><input type="date" id="startDate"></div>
                    <div><label>–ü–æ –¥–∞—Ç—É</label><input type="date" id="endDate"></div>
                </div>
                <button class="btn-primary" onclick="generateReport()"><i class="fa-solid fa-filter"></i> –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏
                    –ó–≤—ñ—Ç</button>
                <div id="reportOutput" style="margin-top: 20px;"></div>
            </div>
        </section>

        <section id="transactions" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-history"></i> –Ü—Å—Ç–æ—Ä—ñ—è –ü—Ä–æ–¥–∞–∂—ñ–≤</h2>
                <div class="grid-3-col" style="margin-bottom: 15px;">
                    <div><input type="text" id="transactionSearch" onkeyup="renderTransactionHistory()"
                            placeholder="üîç –ü–æ—à—É–∫..."></div>
                    <div><select id="historyFilterSource" onchange="renderTransactionHistory()"></select></div>
                    <div><input type="date" id="historyStartDate" onchange="renderTransactionHistory()"></div>
                </div>

                <div class="table-responsive">
                    <table id="transaction-history-table">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ö–ª—ñ—î–Ω—Ç</th>
                                <th>–î–∂–µ—Ä–µ–ª–æ</th>
                                <th>–¢–¢–ù</th>
                                <th>–ü–∞—Ä—Ñ—É–º</th>
                                <th class="text-right">–°—É–º–∞</th>
                                <th class="text-right">–ü—Ä–∏–±—É—Ç–æ–∫</th>
                                <th class="text-right">–î—ñ—è</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <p id="transactionSummary" style="margin-top: 15px; font-weight: 600; text-align: right;"></p>
            </div>
        </section>

        <section id="client-crm" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-users"></i> CRM –ö–ª—ñ—î–Ω—Ç—ñ–≤</h2>
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <input type="text" id="clientSearchInput" list="clientList" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º'—è –∫–ª—ñ—î–Ω—Ç–∞...">
                    <button class="btn-primary" style="width: auto;" onclick="showClientHistory()"><i
                            class="fa-solid fa-search"></i> –ó–Ω–∞–π—Ç–∏</button>
                    <button id="aiClientAnalysisBtn" class="btn-primary"
                        style="width: auto; background: linear-gradient(135deg, #ec4899, #8b5cf6); display: none;"
                        onclick="analyzeClientPreferences()">
                        <i class="fa-solid fa-tags"></i> üè∑Ô∏è –®–Ü –ê–Ω–∞–ª—ñ–∑ —É–ø–æ–¥–æ–±–∞–Ω—å
                    </button>
                </div>
                <div id="clientCrmSummary"></div>
                <div class="table-responsive">
                    <table id="client-history-table">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ü–∞—Ä—Ñ—É–º</th>
                                <th class="text-right">–°—É–º–∞</th>
                                <th class="text-right">–ü—Ä–∏–±—É—Ç–æ–∫</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="admin-panel" class="content-section">
            <div class="grid-2-col" style="margin-bottom: 20px;">
                <button class="btn-primary" onclick="showSection('report', null)">üìä –§—ñ–Ω–∞–Ω—Å–æ–≤—ñ –∑–≤—ñ—Ç–∏</button>
                <button class="btn-primary" onclick="showSection('client-crm', null)">üë• –ë–∞–∑–∞ –∫–ª—ñ—î–Ω—Ç—ñ–≤ (CRM)</button>
                <button class="btn-primary" onclick="showSection('expenses', null)">üí∏ –î–æ–¥–∞—Ç–∏ –í–∏—Ç—Ä–∞—Ç—É</button>
                <button class="btn-primary" onclick="showSection('calculator', null)">üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ü—ñ–Ω–∏</button>
            </div>

            <div class="card">
                <h2><i class="fa-solid fa-warehouse"></i> –°–∫–ª–∞–¥—Å—å–∫–∏–π –æ–±–ª—ñ–∫</h2>
                <div class="scanner-box">
                    <label>üëã –°–∫–∞–Ω—É–≤–∞—Ç–∏ –®—Ç—Ä–∏—Ö-–∫–æ–¥ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è **500 –º–ª** (–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)</label>
                    <input type="text" id="inventoryBarcodeScan" placeholder="–ù–∞–≤–µ–¥—ñ—Ç—å —Å–∫–∞–Ω–µ—Ä..."
                        onchange="scanBarcodeForStock(this.value); this.value='';"
                        onkeydown="if(event.key === 'Enter'){ event.preventDefault(); scanBarcodeForStock(this.value); this.value=''; return false; }">
                </div>

                <h3 style="margin-top: 20px;"><i class="fa-solid fa-plus-square"></i> –î–æ–¥–∞—Ç–∏/–°–ø–∏—Å–∞—Ç–∏ (–í—Ä—É—á–Ω—É)</h3>
                <div class="grid-2-col" style="margin-bottom: 15px;">
                    <div><label>–ü–∞—Ä—Ñ—É–º</label><input type="text" id="inventoryPerfumeName" list="perfumeList"></div>
                    <div><label>–û–±'—î–º (–º–ª)</label><input type="number" id="inventoryVolume" placeholder="–ù–∞–ø—Ä: 500">
                    </div>
                </div>
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="btn-primary" onclick="addStock()" style="width: auto;"><i
                            class="fa-solid fa-plus-square"></i> –î–æ–¥–∞—Ç–∏ –ó–∞–ø–∞—Å</button>
                    <button class="btn-primary" onclick="generateStockForecast()"
                        style="background: linear-gradient(135deg, #f59e0b, #d97706); width: auto;">
                        <i class="fa-solid fa-chart-line"></i> üìä –®–Ü –ü—Ä–æ–≥–Ω–æ–∑ –ó–∞–ª–∏—à–∫—ñ–≤
                    </button>
                </div>

                <div id="stockForecastResult" style="display: none; margin-bottom: 20px;">
                    <div class="card"
                        style="background: rgba(var(--primary-rgb), 0.05); border-left: 5px solid #f59e0b; padding: 20px;">
                        <h3>üìà –ê–Ω–∞–ª—ñ–∑ —Ç–∞ –ü—Ä–æ–≥–Ω–æ–∑ –∑–∞–ª–∏—à–∫—ñ–≤</h3>
                        <div id="stockForecastContent" style="font-size: 0.95rem; line-height: 1.6;"></div>
                        <button class="btn-sm btn-danger" style="margin-top: 15px; width: auto;"
                            onclick="document.getElementById('stockForecastResult').style.display='none'">–ó–∞–∫—Ä–∏—Ç–∏
                            –∑–≤—ñ—Ç</button>
                    </div>
                </div>

                <h4 style="margin-top: 20px; border-top: 1px solid var(--border); padding-top: 15px;">–ü–æ—Ç–æ—á–Ω—ñ –∑–∞–ª–∏—à–∫–∏:
                </h4>

                <div class="filter-bar">
                    <div class="filter-group">
                        <button class="filter-chip active" onclick="filterStockByGender('all', this)">–í—Å—ñ</button>
                        <button class="filter-chip" onclick="filterStockByGender('–ñ—ñ–Ω–æ—á–∏–π', this)">üë© –ñ—ñ–Ω–æ—á—ñ</button>
                        <button class="filter-chip" onclick="filterStockByGender('–ß–æ–ª–æ–≤—ñ—á–∏–π', this)">üë®
                            –ß–æ–ª–æ–≤—ñ—á—ñ</button>
                        <button class="filter-chip" onclick="filterStockByGender('–£–Ω—ñ—Å–µ–∫—Å', this)">üöª –£–Ω—ñ—Å–µ–∫—Å</button>
                    </div>
                </div>
                <div class="table-responsive" style="max-height: 300px; overflow-y: auto;">
                    <table id="inventory-list-table">
                        <thead>
                            <tr>
                                <th>–ù–∞–∑–≤–∞</th>
                                <th class="text-right">–ó–∞–ª–∏—à–æ–∫ (–º–ª)</th>
                                <th class="text-right">–î—ñ—è</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <h3><i class="fa-solid fa-file-invoice"></i> –ü—Ä–∞–π—Å-–ª–∏—Å—Ç –¥–ª—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ (–¶—ñ–Ω–∞ –∑–∞ –º–ª)</h3>
                <label>–í–∏–±–µ—Ä—ñ—Ç—å –Ω–∞—Ü—ñ–Ω–∫—É –¥–ª—è –ø—Ä–∞–π—Å—É:</label>
                <select id="priceListMarkup"></select>
                <button class="btn-warning" style="margin-top: 10px;" onclick="generatePriceList()"><i
                        class="fa-solid fa-list-ul"></i> –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —Ç–∞ —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                <textarea id="priceListOutput" rows="10" readonly
                    placeholder="–¢—É—Ç –±—É–¥–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –ø—Ä–∞–π—Å-–ª–∏—Å—Ç –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è..."
                    style="margin-top: 15px;"></textarea>
            </div>

            <div class="card">
                <h2><i class="fa-solid fa-database"></i> –î–æ–≤—ñ–¥–Ω–∏–∫ –ü–∞—Ä—Ñ—É–º—ñ–≤</h2>
                <div class="admin-form-box">
                    <div class="grid-3-col" style="margin-bottom: 10px;">
                        <div>
                            <label>–ù–∞–∑–≤–∞ –ø–∞—Ä—Ñ—É–º—É</label>
                            <div style="display: flex; gap: 5px;">
                                <input type="text" id="adminPerfumeName" placeholder="–ù–∞–∑–≤–∞ –ø–∞—Ä—Ñ—É–º—É">
                                <button class="btn-primary" onclick="autoFillPerfumeData()"
                                    title="‚ú® AI –ê–≤—Ç–æ–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –∑–∞ –Ω–∞–∑–≤–æ—é" style="width: auto; padding: 0 15px;">
                                    <i class="fa-solid fa-wand-magic-sparkles"></i> AI
                                </button>
                            </div>
                        </div>
                        <div><label>–°/–° (–≥—Ä–Ω/–º–ª)</label><input type="number" id="adminBasePrice" placeholder="0.00">
                        </div>
                        <div><label>–®—Ç—Ä–∏—Ö-–∫–æ–¥</label><input type="text" id="adminBarcode" placeholder="Barcode"></div>
                        <div>
                            <select id="adminGender">
                                <option value="">–û–±–µ—Ä—ñ—Ç—å —Å—Ç–∞—Ç—å</option>
                                <option value="–ñ—ñ–Ω–æ—á–∏–π">üë© –ñ—ñ–Ω–æ—á–∏–π</option>
                                <option value="–ß–æ–ª–æ–≤—ñ—á–∏–π">üë® –ß–æ–ª–æ–≤—ñ—á–∏–π</option>
                                <option value="–£–Ω—ñ—Å–µ–∫—Å">üöª –£–Ω—ñ—Å–µ–∫—Å</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid-2-col" style="margin-bottom: 10px;">
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <label style="margin-bottom: 0; white-space: nowrap;">–°–µ–∑–æ–Ω:</label>
                            <label style="display: inline-flex; align-items: center; gap: 4px; font-weight: 400;"><input
                                    type="checkbox" name="adminSeason" value="–õ—ñ—Ç–æ" style="width: auto;"> ‚òÄÔ∏è
                                –õ—ñ—Ç–æ</label>
                            <label style="display: inline-flex; align-items: center; gap: 4px; font-weight: 400;"><input
                                    type="checkbox" name="adminSeason" value="–ó–∏–º–∞" style="width: auto;"> ‚ùÑÔ∏è
                                –ó–∏–º–∞</label>
                        </div>
                        <input type="text" id="adminTags" placeholder="–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∫–æ–º—É: —Å–≤—ñ–∂–∏–π, –∞–º–±—Ä–∞...)">
                    </div>
                    <div class="grid-2-col" style="margin-bottom: 10px;">
                        <input type="number" id="adminDiscountVolume" placeholder="–û–±'—î–º –¥–ª—è –∑–Ω–∏–∂–∫–∏ (–º–ª)" value="5">
                        <input type="number" id="adminDiscountPrice" placeholder="–°/–° –∑—ñ –∑–Ω–∏–∂–∫–æ—é (–≥—Ä–Ω/–º–ª)">
                    </div>
                    <div style="margin-bottom: 10px;">
                        <label>–ü—ñ—Ä–∞–º—ñ–¥–∞ –∞—Ä–æ–º–∞—Ç—É (–í–µ—Ä—Ö–Ω—ñ, —Å–µ—Ä—Ü–µ, –±–∞–∑–∞)</label>
                        <textarea id="adminPyramid" rows="2"
                            placeholder="–ù–∞–ø—Ä: –í–µ—Ä—Ö–Ω—ñ: –õ–∏–º–æ–Ω, –ú'—è—Ç–∞; –ù–æ—Ç–∏ —Å–µ—Ä—Ü—è: –ñ–∞—Å–º–∏–Ω; –ë–∞–∑–∞: –ö–µ–¥—Ä..."></textarea>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label>–û–ø–∏—Å –∞—Ä–æ–º–∞—Ç—É (—Ö–∞—Ä–∞–∫—Ç–µ—Ä, –¥–ª—è –∫–æ–≥–æ, –∫—É–¥–∏ –Ω–æ—Å–∏—Ç–∏)</label>
                        <textarea id="adminDescription" rows="3" placeholder="–û–ø–∏—à—ñ—Ç—å –∞—Ä–æ–º–∞—Ç –¥–µ—Ç–∞–ª—å–Ω–æ..."></textarea>
                    </div>
                    <button class="btn-success" onclick="addOrUpdatePerfume()"><i class="fa-solid fa-save"></i>
                        –ó–±–µ—Ä–µ–≥—Ç–∏/–û–Ω–æ–≤–∏—Ç–∏</button>
                </div>

                <div class="filter-bar">
                    <div class="filter-group">
                        <button class="filter-chip active"
                            onclick="setCatalogFilter('gender', 'all', this)">–í—Å—ñ</button>
                        <button class="filter-chip" onclick="setCatalogFilter('gender', '–ñ—ñ–Ω–æ—á–∏–π', this)">üë©
                            –ñ—ñ–Ω–æ—á—ñ</button>
                        <button class="filter-chip" onclick="setCatalogFilter('gender', '–ß–æ–ª–æ–≤—ñ—á–∏–π', this)">üë®
                            –ß–æ–ª–æ–≤—ñ—á—ñ</button>
                        <button class="filter-chip" onclick="setCatalogFilter('gender', '–£–Ω—ñ—Å–µ–∫—Å', this)">üöª
                            –£–Ω—ñ—Å–µ–∫—Å</button>
                    </div>
                    <div class="filter-group">
                        <button class="filter-chip active" onclick="setCatalogFilter('season', 'all', this)">–ë—É–¥—å-—è–∫–∏–π
                            —Å–µ–∑–æ–Ω</button>
                        <button class="filter-chip" onclick="setCatalogFilter('season', '–õ—ñ—Ç–æ', this)">‚òÄÔ∏è –õ—ñ—Ç–Ω—ñ</button>
                        <button class="filter-chip" onclick="setCatalogFilter('season', '–ó–∏–º–∞', this)">‚ùÑÔ∏è
                            –ó–∏–º–æ–≤—ñ</button>
                    </div>
                </div>

                <input type="text" id="perfumeSearchInput" onkeyup="renderPerfumeList()"
                    placeholder="üîç –ü–æ—à—É–∫ —É –¥–æ–≤—ñ–¥–Ω–∏–∫—É..." style="margin-bottom: 10px;">
                <div class="table-responsive" style="max-height: 300px; overflow-y: auto;">
                    <table id="perfume-list-table">
                        <thead>
                            <tr>
                                <th>–ù–∞–∑–≤–∞</th>
                                <th class="text-right">–°/–°</th>
                                <th class="text-right">–î—ñ—è</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <h3><i class="fa-solid fa-flask"></i> –§–ª–∞–∫–æ–Ω–∏ & –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h3>
                <div class="grid-2-col">
                    <div>
                        <label>–î–æ–¥–∞—Ç–∏ –§–ª–∞–∫–æ–Ω (–û–±'—î–º / –¶—ñ–Ω–∞)</label>
                        <div style="display: flex; gap: 5px;">
                            <input type="number" id="adminFlaconVolume" placeholder="–º–ª">
                            <input type="number" id="adminFlaconCost" placeholder="–≥—Ä–Ω">
                            <button class="btn-success" style="width: auto;" onclick="addOrUpdateFlacon()"><i
                                    class="fa-solid fa-plus"></i></button>
                        </div>
                    </div>
                    <div>
                        <label>–î–æ–¥–∞—Ç–∏ –ù–∞—Ü—ñ–Ω–∫—É (–ù–∞–∑–≤–∞ / –ö–æ–µ—Ñ)</label>
                        <div style="display: flex; gap: 5px;">
                            <input type="text" id="adminMarkupName" placeholder="–ù–∞–ø—Ä: VIP">
                            <input type="number" id="adminMarkupValue" placeholder="0.10">
                            <button class="btn-success" style="width: auto;" onclick="addOrUpdateMarkupPreset()"><i
                                    class="fa-solid fa-plus"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3><i class="fa-solid fa-database"></i> –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –î–∞–Ω–∏–º–∏</h3>
                <button class="btn-primary" onclick="exportDataToJSON()"><i class="fa-solid fa-download"></i> –ó—Ä–æ–±–∏—Ç–∏
                    –ë–µ–∫-–∞–ø (JSON)</button>
                <h4 style="margin-top: 20px; border-top: 1px solid var(--border); padding-top: 15px;">–í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –î–∞–Ω—ñ:
                </h4>
                <input type="file" id="importFileInput" accept=".json" style="margin-bottom: 10px;">
                <button class="btn-danger" onclick="importDataFromJSON()"><i class="fa-solid fa-upload"></i> –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑
                    –§–∞–π–ª—É</button>
                <h4 style="margin-top: 20px; border-top: 1px solid var(--border); padding-top: 15px;">–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è
                    (Text):</h4>
                <button class="btn-warning" onclick="showSyncModal()"><i class="fa-solid fa-link"></i> –í—ñ–¥–∫—Ä–∏—Ç–∏ –ú–æ–¥–∞–ª—å–Ω–µ
                    –≤—ñ–∫–Ω–æ</button>
            </div>
        </section>

        <section id="ai-assistant" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-robot"></i> AI –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –ü–æ–º—ñ—á–Ω–∏–∫</h2>
                <p style="color:var(--text-muted); margin-bottom: 15px;">–Ø ‚Äî –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä. –í—Å—Ç–∞–≤—Ç–µ –¥—ñ–∞–ª–æ–≥ –∑
                    –∫–ª—ñ—î–Ω—Ç–æ–º, —ñ —è –¥–æ–ø–æ–º–æ–∂—É –∑ –ø–æ—Ä–∞–¥–∞–º–∏, —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∞–º–∏ —Ç–∞ –ø—ñ–¥–±–æ—Ä–æ–º –∞—Ä–æ–º–∞—Ç—ñ–≤.</p>

                <div class="parser-area" style="min-height: 200px; display: flex; flex-direction: column;">
                    <textarea id="adminAiChatInput"
                        placeholder="–í—Å—Ç–∞–≤—Ç–µ –¥—ñ–∞–ª–æ–≥ –∞–±–æ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è —Ç—É—Ç (–Ω–∞–ø—Ä: '–ü–æ—Ä–∞–¥—å —â–æ—Å—å —Å—Ö–æ–∂–µ –Ω–∞ Baccarat Rouge —Ç–∞ –ø–æ—Ä–∞—Ö—É–π –æ–ª—Ö –¥–æ—Å—Ç–∞–≤–∫—É')..."
                        style="flex-grow: 1; min-height: 120px;"></textarea>
                    <button class="btn-primary" style="margin-top: 10px;" onclick="runAdminAI()">
                        <i class="fa-solid fa-paper-plane"></i> –ó–∞–ø–∏—Ç–∞—Ç–∏ AI
                    </button>
                </div>

                <div id="adminAiResponse" class="card"
                    style="display: none; background: rgba(var(--primary-rgb), 0.05); border-left: 4px solid var(--primary); margin-top: 20px;">
                    <div style="font-weight: 700; margin-bottom: 10px; color: var(--primary);">ü§ñ –í—ñ–¥–ø–æ–≤—ñ–¥—å AI:</div>
                    <div id="adminAiResponseContent" style="line-height: 1.6; white-space: pre-wrap;"></div>
                </div>
            </div>
        </section>

        <section id="smm-creator" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-camera-retro"></i> SMM –ö—Ä—ñ–µ–π—Ç–æ—Ä</h2>
                <div class="grid-2-col" style="margin-bottom: 15px;">
                    <div>
                        <label>–û–±–µ—Ä—ñ—Ç—å –∞—Ä–æ–º–∞—Ç –¥–ª—è –ø—Ä–æ—Å—É–≤–∞–Ω–Ω—è</label>
                        <input type="text" id="smmPerfumeName" list="perfumeList"
                            placeholder="–ü–æ—á–Ω—ñ—Ç—å –≤–≤–æ–¥–∏—Ç–∏ –Ω–∞–∑–≤—É...">
                    </div>
                    <div>
                        <label>–¶—ñ–ª—å –∫–æ–Ω—Ç–µ–Ω—Ç—É</label>
                        <select id="smmGoal">
                            <option value="post">–ü–æ—Å—Ç –¥–ª—è Instagram</option>
                            <option value="story">–°—Ü–µ–Ω–∞—Ä—ñ–π Story</option>
                            <option value="ads">–†–µ–∫–ª–∞–º–Ω–∏–π —Ç–µ–∫—Å—Ç (Ads)</option>
                            <option value="strategy">–°—Ç—Ä–∞—Ç–µ–≥—ñ—è –ø—Ä–æ—Å—É–≤–∞–Ω–Ω—è</option>
                        </select>
                    </div>
                </div>
                <button class="btn-success" onclick="generateSMMContent()">
                    <i class="fa-solid fa-magic"></i> –°–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç
                </button>

                <div id="smmOutput" class="card"
                    style="display: none; margin-top: 20px; border-top: 2px solid var(--secondary);">
                    <h3>üìù –†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
                    <div id="smmOutputContent" style="white-space: pre-wrap; font-size: 0.95rem; line-height: 1.6;">
                    </div>
                </div>
            </div>
        </section>

        <section id="expenses" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-money-bill-wave"></i> –î–æ–¥–∞—Ç–∏ –í–∏—Ç—Ä–∞—Ç—É</h2>
                <div class="grid-2-col" style="margin-bottom: 15px;">
                    <div><label>–û–ø–∏—Å –≤–∏—Ç—Ä–∞—Ç–∏</label><input type="text" id="expenseDescription"
                            placeholder="–ù–∞–ø—Ä: –ù–æ–≤–∞ –ü–æ—à—Ç–∞ –∑–∞ —Ç–∏–∂–¥–µ–Ω—å"></div>
                    <div><label>–°—É–º–∞ (‚Ç¥)</label><input type="number" id="expenseAmount" placeholder="–ù–∞–ø—Ä: 150.50">
                    </div>
                </div>
                <button class="btn-danger" onclick="addExpense()"><i class="fa-solid fa-minus-circle"></i> –ó–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏
                    –í–∏—Ç—Ä–∞—Ç—É</button>
                <div id="expenseListOutput" style="margin-top: 20px;"></div>
            </div>
        </section>

        <section id="calculator" class="content-section">
            <div class="card">
                <h2><i class="fa-solid fa-calculator"></i> –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ü—ñ–Ω–∏</h2>
                <div class="grid-3-col" style="margin-bottom: 15px;">
                    <div><label>–ü–∞—Ä—Ñ—É–º</label><input type="text" id="calcPerfumeName" list="perfumeList"></div>
                    <div><label>–û–±'—î–º</label><select id="calcFlaconVolume"></select></div>
                    <div><label>–ù–∞—Ü—ñ–Ω–∫–∞</label><select id="calcMarkupTier"></select></div>
                </div>
                <button class="btn-primary" onclick="calculateRetailPrice()"><i class="fa-solid fa-search-dollar"></i>
                    –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
                <div id="calculatorOutput" style="margin-top: 20px;"></div>
            </div>
        </section>

    </div>

    <div id="receiptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header no-print">
                <h3 style="margin:0;">–ß–µ–∫-–æ—Ä–¥–µ—Ä</h3>
                <button class="btn-sm" style="width:auto" onclick="closeReceiptModal()">‚úï</button>
            </div>
            <div class="modal-body" id="receiptContent"></div>
        </div>
    </div>

    <div id="syncModal" class="modal">
        <div class="modal-content">
            <div class="modal-header no-print">
                <h3 style="margin:0;">–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –î–∞–Ω–∏—Ö</h3>
                <button class="btn-sm" style="width:auto" onclick="closeSyncModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <p>–°–∫–æ–ø—ñ—é–π—Ç–µ —Ü–µ–π —Ç–µ–∫—Å—Ç –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ —ñ–Ω—à–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó.</p>
                <textarea id="syncDataOutput" rows="15" readonly
                    style="width: 100%; resize: none; font-size: 0.75rem;"></textarea>
                <button class="btn-success" style="margin-top: 10px;" onclick="copySyncData()"><i
                        class="fa-solid fa-copy"></i> –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                <p style="margin-top: 20px; border-top: 1px dashed var(--border); padding-top: 15px;">**–ê–ë–û –í–°–¢–ê–í–ò–¢–ò –î–õ–Ø
                    –Ü–ú–ü–û–†–¢–£:**</p>
                <textarea id="syncDataInput" rows="5" placeholder="–í—Å—Ç–∞–≤—Ç–µ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ —Å—é–¥–∏..."
                    style="width: 100%; resize: none;"></textarea>
                <button class="btn-warning" style="margin-top: 10px;" onclick="importDataFromSync()"><i
                        class="fa-solid fa-upload"></i> –í—ñ–¥–Ω–æ–≤–∏—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL (AI API) -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h3>
                <button onclick="closeSettingsModal()" class="btn-sm btn-danger">X</button>
            </div>
            <div class="modal-body">
                <label>üîë Gemini API Key:</label>
                <input type="text" id="apiKeyInput" value="AIzaSyDYtCM1M61MG18zX3KZD2jfwofLmKvPG9U"
                    placeholder="AIzaSy..." onchange="saveApiKey(this.value)">
                <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 5px;">
                    –ö–ª—é—á –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ª–∏—à–µ —É –≤–∞—à–æ–º—É –±—Ä–∞—É–∑–µ—Ä—ñ (Local Storage). <br>
                    <a href="https://aistudio.google.com/app/apikey" target="_blank">–û—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—é—á Gemini</a>
                </p>
                <div
                    style="background: rgba(var(--primary-rgb), 0.1); padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 3px solid var(--primary);">
                    <label>ü§ñ –ú–æ–¥–µ–ª—å –®–Ü:</label>
                    <select id="geminiModelSelect" onchange="localStorage.setItem('gemini_model', this.value)"
                        style="margin-top: 5px;">
                        <option value="gemini-2.0-flash-lite">Gemini 2.0 Flash-Lite (–ö—Ä–∞—â–∞ –∫–≤–æ—Ç–∞)</option>
                        <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash-Lite (–ù–∞–π–Ω–æ–≤—ñ—à–∞)</option>
                        <option value="gemini-2.0-flash">Gemini 2.0 Flash (–®–≤–∏–¥–∫–∞)</option>
                        <option value="gemini-2.5-flash">Gemini 2.5 Flash (–ü–æ—Ç—É–∂–Ω–∞)</option>
                    </select>
                </div>

                <hr style="margin: 20px 0; border: 0; border-top: 1px solid var(--border);">

                <h3>‚òÅÔ∏è –•–º–∞—Ä–∞ (Supabase)</h3>
                <label>Project URL:</label>
                <input type="text" id="supabaseUrlInput" placeholder="https://xyz.supabase.co"
                    onchange="saveSupabaseConfig()">

                <label style="margin-top: 10px;">API Key (public/anon):</label>
                <input type="password" id="supabaseKeyInput" placeholder="eyJhbGciOiJIUzI1NiIsIn..."
                    onchange="saveSupabaseConfig()">

                <div style="display: flex; gap: 10px; margin-top: 15px;">
                    <button class="btn-success" onclick="testSupabaseConnection()">üîå –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è</button>
                    <button class="btn-warning" onclick="syncWithCloud()">‚òÅÔ∏è –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ —Ö–º–∞—Ä—É</button>
                    <button class="btn-danger" onclick="loadFromCloud()">üì• –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑ —Ö–º–∞—Ä–∏</button>
                </div>

                <!-- Sync Status Display -->
                <div id="syncStatusDisplay" style="margin-top: 15px;"></div>
            </div>
        </div>
    </div>

    <datalist id="perfumeList"></datalist>
    <datalist id="clientList"></datalist>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>

</body>

</html>